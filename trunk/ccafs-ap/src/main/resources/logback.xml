<configuration>
  <contextName>CCAFS Activities</contextName>
  <property file="ccafsap.properties" />

  <!-- ***************************************************************************** -->
  <!-- ccafsap-dev is a developer log file, just TRACE and DEBUG messages are showed --> 
  
  <appender name="DEV_TRACE" class="ch.qos.logback.core.rolling.RollingFileAppender">
    <file>${log.folder}/ccafsap-dev.log</file>
    <filter class="ch.qos.logback.classic.filter.LevelFilter">
      <level>TRACE</level>
      <onMatch>ACCEPT</onMatch>
      <onMismatch>DENY</onMismatch>
    </filter>
    <encoder>
      <pattern>%d{HH:mm:ss.SSS} - %logger{0} [%-5level] : %msg%n</pattern>
    </encoder>
    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
      <!-- rollover daily -->
      <fileNamePattern>ccafsap-dev-%d{yyyy-MM-dd}.%i.txt</fileNamePattern>
      <timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
        <!-- or whenever the file size reaches 10MB -->
        <maxFileSize>10MB</maxFileSize>
      </timeBasedFileNamingAndTriggeringPolicy>
    </rollingPolicy>
  </appender>
  
  <appender name="DEV_DEBUG" class="ch.qos.logback.core.FileAppender">
    <file>${log.folder}/ccafsap-dev.log</file>
    <filter class="ch.qos.logback.classic.filter.LevelFilter">
      <level>DEBUG</level>
      <onMatch>ACCEPT</onMatch>
      <onMismatch>DENY</onMismatch>
    </filter>
    <encoder>
      <pattern>%d{HH:mm:ss.SSS} - %logger{0} [%-5level] : %msg%n</pattern>
    </encoder>
  </appender>
   
  <!-- ************************************************************************* -->
  <!-- ccafsap is the general log file, INFO, WARN and ERROR messages are showed --> 
  
  <appender name="GENERAL" class="ch.qos.logback.core.rolling.RollingFileAppender">
    <file>${log.folder}/ccafsap.log</file>
    <filter class="ch.qos.logback.classic.filter.ThresholdFilter">
      <level>INFO</level>
    </filter>
    <encoder>
      <pattern>%d{HH:mm:ss.SSS} - %logger{0} [%-5level] : %msg%n</pattern>
    </encoder>
    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
      <!-- rollover daily -->
      <fileNamePattern>ccafsap-%d{yyyy-MM-dd}.%i.txt</fileNamePattern>
      <timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
        <!-- or whenever the file size reaches 10MB -->
        <maxFileSize>10MB</maxFileSize>
      </timeBasedFileNamingAndTriggeringPolicy>
    </rollingPolicy>
  </appender>
  
  
  <!-- ************************************************************************* -->
  <!-- This is a console log used to develop purposes --> 
  
  <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
    <encoder>
      <pattern>%d{HH:mm:ss.SSS} - %logger{0} [%-5level] : %msg%n</pattern>
    </encoder>
  </appender>
  
   
  <root level="ALL">
    <if condition='property("log.toConsole").equalsIgnoreCase("true")'> 
	    <then>
        <appender-ref ref="STDOUT"/>
	    </then>
    </if>
    
    <if condition='property("log.toFile").equalsIgnoreCase("true")'> 
	    <then>
	      <appender-ref ref="GENERAL" />  
			  <appender-ref ref="DEV_TRACE" />  
			  <appender-ref ref="DEV_DEBUG" />
	    </then>
    </if>
  </root>
</configuration>